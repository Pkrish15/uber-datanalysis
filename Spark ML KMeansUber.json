{"paragraphs":[{"title":"Import needed packages","text":"import org.apache.spark._\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.Dataset\nimport org.apache.spark.sql.types.TimestampType\nimport org.apache.spark.ml.feature.VectorAssembler\nimport org.apache.spark.ml.clustering.KMeans","user":"anonymous","dateUpdated":"2018-02-28T09:55:48-0800","config":{"editorSetting":{"language":"scala"},"colWidth":11,"editorMode":"ace/mode/scala","title":true,"results":[{"graph":{"mode":"table","height":156,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark._\n\nimport org.apache.spark.sql.SparkSession\n\nimport org.apache.spark.sql.functions._\n\nimport org.apache.spark.sql.types._\n\nimport org.apache.spark.sql._\n\nimport org.apache.spark.sql.Dataset\n\nimport org.apache.spark.sql.types.TimestampType\n\nimport org.apache.spark.ml.feature.VectorAssembler\n\nimport org.apache.spark.ml.clustering.KMeans\n"}]},"apps":[],"jobName":"paragraph_1506542893552_1814413370","id":"20161030-025214_1655763979","dateCreated":"2017-09-27T13:08:13-0700","dateStarted":"2018-02-28T09:55:48-0800","dateFinished":"2018-02-28T09:56:37-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:41770"},{"title":"Define Schema for csv file data","text":"\ncase class Uber(dt: String, lat: Double, lon: Double, base: String) extends Serializable\n\nval schema = StructType(Array(\n      StructField(\"dt\", TimestampType, true),\n      StructField(\"lat\", DoubleType, true),\n      StructField(\"lon\", DoubleType, true),\n      StructField(\"base\", StringType, true)\n))\n","user":"anonymous","dateUpdated":"2018-02-20T08:35:22-0800","config":{"editorSetting":{"language":"scala"},"colWidth":11,"editorMode":"ace/mode/scala","title":true,"results":[{"graph":{"mode":"table","height":86,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndefined class Uber\n\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(dt,TimestampType,true), StructField(lat,DoubleType,true), StructField(lon,DoubleType,true), StructField(base,StringType,true))\n"}]},"apps":[],"jobName":"paragraph_1506542893555_1814798119","id":"20161030-030543_519944270","dateCreated":"2017-09-27T13:08:13-0700","dateStarted":"2018-02-20T08:35:22-0800","dateFinished":"2018-02-20T08:35:27-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41771"},{"title":"Read the data from CSV file into a Dataset of Account type","text":"import sqlContext.implicits._\nval df: Dataset[Uber] = spark.read.option(\"inferSchema\", \"false\").schema(schema).csv(\"/user/user01/data/uber.csv\").as[Uber]\ndf.cache\ndf.take(2)\ndf.show\n\n","user":"anonymous","dateUpdated":"2018-02-20T08:54:18-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport sqlContext.implicits._\n\ndf: org.apache.spark.sql.Dataset[Uber] = [dt: timestamp, lat: double ... 2 more fields]\n\nres17: df.type = [dt: timestamp, lat: double ... 2 more fields]\n\nres18: Array[Uber] = Array(Uber(2014-08-01 00:00:00,40.729,-73.9422,B02598), Uber(2014-08-01 00:00:00,40.7476,-73.9871,B02598))\n+--------------------+-------+--------+------+\n|                  dt|    lat|     lon|  base|\n+--------------------+-------+--------+------+\n|2014-08-01 00:00:...| 40.729|-73.9422|B02598|\n|2014-08-01 00:00:...|40.7476|-73.9871|B02598|\n|2014-08-01 00:00:...|40.7424|-74.0044|B02598|\n|2014-08-01 00:00:...| 40.751|-73.9869|B02598|\n|2014-08-01 00:00:...|40.7406|-73.9902|B02598|\n|2014-08-01 00:00:...|40.6994|-73.9591|B02617|\n|2014-08-01 00:00:...|40.6917|-73.9398|B02617|\n|2014-08-01 00:00:...|40.7063|-73.9223|B02617|\n|2014-08-01 00:00:...|40.6759|-74.0168|B02617|\n|2014-08-01 00:00:...|40.7617|-73.9847|B02617|\n|2014-08-01 00:00:...|40.6969|-73.9064|B02617|\n|2014-08-01 00:00:...|40.7623|-73.9751|B02617|\n|2014-08-01 00:00:...|40.6982|-73.9669|B02617|\n|2014-08-01 00:00:...|40.7553|-73.9253|B02617|\n|2014-08-01 00:00:...|40.7325|-73.9876|B02682|\n|2014-08-01 00:00:...|40.6754| -74.017|B02682|\n|2014-08-01 00:00:...|40.7303|-74.0029|B02682|\n|2014-08-01 00:00:...|40.7218|-73.9973|B02682|\n|2014-08-01 00:00:...|40.7134|-74.0091|B02682|\n|2014-08-01 00:00:...|40.7194|-73.9964|B02682|\n+--------------------+-------+--------+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1506542893555_1814798119","id":"20161030-030618_394385178","dateCreated":"2017-09-27T13:08:13-0700","dateStarted":"2018-02-20T08:54:18-0800","dateFinished":"2018-02-20T08:54:26-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41772"},{"text":"df.printSchema","user":"anonymous","dateUpdated":"2018-02-20T08:35:52-0800","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala"},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- dt: timestamp (nullable = true)\n |-- lat: double (nullable = true)\n |-- lon: double (nullable = true)\n |-- base: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1506542893557_1812489625","id":"20161030-030707_2084899217","dateCreated":"2017-09-27T13:08:13-0700","dateStarted":"2018-02-20T08:35:53-0800","dateFinished":"2018-02-20T08:36:10-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41773"},{"title":"Define Features Array","text":"\nval featureCols = Array(\"lat\", \"lon\")\nval assembler = new VectorAssembler().setInputCols(featureCols).setOutputCol(\"features\")\nval df2 = assembler.transform(df)\ndf2.show","user":"anonymous","dateUpdated":"2018-02-20T08:36:04-0800","config":{"tableHide":false,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nfeatureCols: Array[String] = Array(lat, lon)\n\nassembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_9026b68370a5\n\ndf2: org.apache.spark.sql.DataFrame = [dt: timestamp, lat: double ... 3 more fields]\n+--------------------+-------+--------+------+------------------+\n|                  dt|    lat|     lon|  base|          features|\n+--------------------+-------+--------+------+------------------+\n|2014-08-01 00:00:...| 40.729|-73.9422|B02598| [40.729,-73.9422]|\n|2014-08-01 00:00:...|40.7476|-73.9871|B02598|[40.7476,-73.9871]|\n|2014-08-01 00:00:...|40.7424|-74.0044|B02598|[40.7424,-74.0044]|\n|2014-08-01 00:00:...| 40.751|-73.9869|B02598| [40.751,-73.9869]|\n|2014-08-01 00:00:...|40.7406|-73.9902|B02598|[40.7406,-73.9902]|\n|2014-08-01 00:00:...|40.6994|-73.9591|B02617|[40.6994,-73.9591]|\n|2014-08-01 00:00:...|40.6917|-73.9398|B02617|[40.6917,-73.9398]|\n|2014-08-01 00:00:...|40.7063|-73.9223|B02617|[40.7063,-73.9223]|\n|2014-08-01 00:00:...|40.6759|-74.0168|B02617|[40.6759,-74.0168]|\n|2014-08-01 00:00:...|40.7617|-73.9847|B02617|[40.7617,-73.9847]|\n|2014-08-01 00:00:...|40.6969|-73.9064|B02617|[40.6969,-73.9064]|\n|2014-08-01 00:00:...|40.7623|-73.9751|B02617|[40.7623,-73.9751]|\n|2014-08-01 00:00:...|40.6982|-73.9669|B02617|[40.6982,-73.9669]|\n|2014-08-01 00:00:...|40.7553|-73.9253|B02617|[40.7553,-73.9253]|\n|2014-08-01 00:00:...|40.7325|-73.9876|B02682|[40.7325,-73.9876]|\n|2014-08-01 00:00:...|40.6754| -74.017|B02682| [40.6754,-74.017]|\n|2014-08-01 00:00:...|40.7303|-74.0029|B02682|[40.7303,-74.0029]|\n|2014-08-01 00:00:...|40.7218|-73.9973|B02682|[40.7218,-73.9973]|\n|2014-08-01 00:00:...|40.7134|-74.0091|B02682|[40.7134,-74.0091]|\n|2014-08-01 00:00:...|40.7194|-73.9964|B02682|[40.7194,-73.9964]|\n+--------------------+-------+--------+------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1506542893558_1813643872","id":"20161030-041240_922666463","dateCreated":"2017-09-27T13:08:13-0700","dateStarted":"2018-02-20T08:36:10-0800","dateFinished":"2018-02-20T08:36:18-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41774"},{"title":"Create KMeans Estimator","text":"val kmeans = new KMeans().setK(10).setFeaturesCol(\"features\").setMaxIter(10).setSeed(1L)","user":"anonymous","dateUpdated":"2018-02-20T08:36:25-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nkmeans: org.apache.spark.ml.clustering.KMeans = kmeans_841348e88041\n"}]},"apps":[],"jobName":"paragraph_1506542893561_1810950630","id":"20170710-141916_128183205","dateCreated":"2017-09-27T13:08:13-0700","dateStarted":"2018-02-20T08:36:25-0800","dateFinished":"2018-02-20T08:36:26-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41775"},{"title":"Fit the model to the Training data ","text":"val Array(trainingData, testData) = df2.randomSplit(Array(0.7, 0.3), 5043)\nval model = kmeans.fit(trainingData)\nprintln(\"Final Centers: \")\nmodel.clusterCenters.foreach(println)","user":"anonymous","dateUpdated":"2018-02-20T08:36:28-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n\ntrainingData: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [dt: timestamp, lat: double ... 3 more fields]\ntestData: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [dt: timestamp, lat: double ... 3 more fields]\n\nmodel: org.apache.spark.ml.clustering.KMeansModel = kmeans_841348e88041\nFinal Centers: \n[40.76664545866995,-73.971943532955]\n[40.65691441787581,-73.77858448387752]\n[40.68823447858158,-73.96356479112092]\n[40.8846089384911,-73.89323734976253]\n[40.731016671638834,-73.99784478036213]\n[40.76976556205323,-73.46255302144253]\n[40.706143242760135,-74.18034851626766]\n[40.75991344894163,-73.8731900081874]\n[40.199034310850436,-74.04456129032259]\n[40.66923121387281,-74.40504373795766]\n"}]},"apps":[],"jobName":"paragraph_1506542893562_1812104876","id":"20170710-143129_239931631","dateCreated":"2017-09-27T13:08:13-0700","dateStarted":"2018-02-20T08:36:29-0800","dateFinished":"2018-02-20T08:37:17-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41776"},{"text":"val cc = model.clusterCenters\ncc(0)","user":"anonymous","dateUpdated":"2018-02-20T08:36:33-0800","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ncc: Array[org.apache.spark.ml.linalg.Vector] = Array([40.76664545866995,-73.971943532955], [40.65691441787581,-73.77858448387752], [40.68823447858158,-73.96356479112092], [40.8846089384911,-73.89323734976253], [40.731016671638834,-73.99784478036213], [40.76976556205323,-73.46255302144253], [40.706143242760135,-74.18034851626766], [40.75991344894163,-73.8731900081874], [40.199034310850436,-74.04456129032259], [40.66923121387281,-74.40504373795766])\n\nres10: org.apache.spark.ml.linalg.Vector = [40.76664545866995,-73.971943532955]\n"}]},"apps":[],"jobName":"paragraph_1508851487974_-1475014921","id":"20171024-062447_1209452772","dateCreated":"2017-10-24T06:24:47-0700","dateStarted":"2018-02-20T08:36:33-0800","dateFinished":"2018-02-20T08:37:19-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41777"},{"title":"Get Cluster groupings for Evaluation","text":"val clusters = model.summary.predictions\nclusters.show()\nclusters.registerTempTable(\"uber\")","user":"anonymous","dateUpdated":"2018-02-20T08:36:38-0800","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nclusters: org.apache.spark.sql.DataFrame = [dt: timestamp, lat: double ... 4 more fields]\n+--------------------+-------+--------+------+------------------+----------+\n|                  dt|    lat|     lon|  base|          features|prediction|\n+--------------------+-------+--------+------+------------------+----------+\n|2014-08-01 00:00:...|40.3495|-74.0667|B02682|[40.3495,-74.0667]|         8|\n|2014-08-01 00:00:...|40.6754| -74.017|B02682| [40.6754,-74.017]|         2|\n|2014-08-01 00:00:...|40.6917|-73.9398|B02617|[40.6917,-73.9398]|         2|\n|2014-08-01 00:00:...|40.6969|-73.9064|B02617|[40.6969,-73.9064]|         2|\n|2014-08-01 00:00:...|40.6994|-73.9591|B02617|[40.6994,-73.9591]|         2|\n|2014-08-01 00:00:...|40.7063|-73.9223|B02617|[40.7063,-73.9223]|         2|\n|2014-08-01 00:00:...|40.7194|-73.9964|B02682|[40.7194,-73.9964]|         4|\n|2014-08-01 00:00:...|40.7218|-73.9973|B02682|[40.7218,-73.9973]|         4|\n|2014-08-01 00:00:...| 40.729|-73.9422|B02598| [40.729,-73.9422]|         2|\n|2014-08-01 00:00:...|40.7303|-74.0029|B02682|[40.7303,-74.0029]|         4|\n|2014-08-01 00:00:...|40.7325|-73.9876|B02682|[40.7325,-73.9876]|         4|\n|2014-08-01 00:00:...|40.7406|-73.9902|B02598|[40.7406,-73.9902]|         4|\n|2014-08-01 00:00:...|40.7424|-74.0044|B02598|[40.7424,-74.0044]|         4|\n|2014-08-01 00:00:...|40.7476|-73.9871|B02598|[40.7476,-73.9871]|         4|\n|2014-08-01 00:00:...| 40.751|-73.9869|B02598| [40.751,-73.9869]|         0|\n|2014-08-01 00:00:...|40.7553|-73.9253|B02617|[40.7553,-73.9253]|         0|\n|2014-08-01 00:00:...|40.7617|-73.9847|B02617|[40.7617,-73.9847]|         0|\n|2014-08-01 00:00:...| 40.762| -73.983|B02682|  [40.762,-73.983]|         0|\n|2014-08-01 00:00:...|40.7623|-73.9751|B02617|[40.7623,-73.9751]|         0|\n|2014-08-01 00:01:...|40.6447| -73.782|B02617| [40.6447,-73.782]|         1|\n+--------------------+-------+--------+------+------------------+----------+\nonly showing top 20 rows\n\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1508847928942_451346798","id":"20171024-052528_79661538","dateCreated":"2017-10-24T05:25:28-0700","dateStarted":"2018-02-20T08:37:17-0800","dateFinished":"2018-02-20T08:37:28-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41778"},{"text":"%sql\n\nSELECT * from uber limit 5","user":"anonymous","dateUpdated":"2018-02-20T08:59:09-0800","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"dt\tlat\tlon\tbase\tfeatures\tprediction\n2014-08-01 00:00:00.0\t40.3495\t-74.0667\tB02682\t[40.3495,-74.0667]\t8\n2014-08-01 00:00:00.0\t40.6754\t-74.017\tB02682\t[40.6754,-74.017]\t2\n2014-08-01 00:00:00.0\t40.6917\t-73.9398\tB02617\t[40.6917,-73.9398]\t2\n2014-08-01 00:00:00.0\t40.6969\t-73.9064\tB02617\t[40.6969,-73.9064]\t2\n2014-08-01 00:00:00.0\t40.6994\t-73.9591\tB02617\t[40.6994,-73.9591]\t2\n"}]},"apps":[],"jobName":"paragraph_1519145937883_-1932734012","id":"20180220-085857_1376421019","dateCreated":"2018-02-20T08:58:57-0800","dateStarted":"2018-02-20T08:59:09-0800","dateFinished":"2018-02-20T08:59:11-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41779"},{"title":"How many pickups occurred in each cluster?","text":"clusters.groupBy(\"prediction\").count().orderBy(desc( \"count\")).show","user":"anonymous","dateUpdated":"2018-02-20T08:36:42-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+------+\n|prediction| count|\n+----------+------+\n|         4|234502|\n|         0|196370|\n|         2| 86672|\n|         7| 26846|\n|         1| 18464|\n|         3|  9870|\n|         6|  5594|\n|         5|  1550|\n|         9|   519|\n|         8|   341|\n+----------+------+\n\n"}]},"apps":[],"jobName":"paragraph_1506542893568_1500458267","id":"20170710-160950_712231335","dateCreated":"2017-09-27T13:08:13-0700","dateStarted":"2018-02-20T08:37:19-0800","dateFinished":"2018-02-20T08:37:40-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41780"},{"title":"Cluster Centers on Map","text":"%md\n\n<hr />\n![](https://lh4.googleusercontent.com/SXd36pFFHMhMCYGntY_JjDcv3gLmM5Rv4n-owZwrWQ0XCbQhRlcs8rdk8ZbcVjKlqABAYm8z9IrSWvaMjyyUJ0OWrSNg-3wdAisSNyobGgCWsQXLDe5GcNBgZ8VZBQXKsxIbWNq0)","user":"anonymous","dateUpdated":"2018-02-20T09:01:51-0800","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<hr />\n<p><img src=\"https://lh4.googleusercontent.com/SXd36pFFHMhMCYGntY_JjDcv3gLmM5Rv4n-owZwrWQ0XCbQhRlcs8rdk8ZbcVjKlqABAYm8z9IrSWvaMjyyUJ0OWrSNg-3wdAisSNyobGgCWsQXLDe5GcNBgZ8VZBQXKsxIbWNq0\" /></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1508855786825_-1727101548","id":"20171024-073626_729569695","dateCreated":"2017-10-24T07:36:26-0700","dateStarted":"2017-10-24T09:21:16-0700","dateFinished":"2017-10-24T09:21:16-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41781"},{"title":"How many pickups occurred in each cluster?","text":"%sql\nSELECT COUNT(prediction) as count, prediction FROM uber\nGROUP BY prediction ORDER BY COUNT(prediction) DESC","user":"anonymous","dateUpdated":"2018-02-20T09:04:16-0800","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"prediction","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":0,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":true},"editorMode":"ace/mode/sql","title":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count\tprediction\n234502\t4\n196370\t0\n86672\t2\n26846\t7\n18464\t1\n9870\t3\n5594\t6\n1550\t5\n519\t9\n341\t8\n"}]},"apps":[],"jobName":"paragraph_1519146030734_1398711480","id":"20180220-090030_1108428066","dateCreated":"2018-02-20T09:00:30-0800","dateStarted":"2018-02-20T09:02:06-0800","dateFinished":"2018-02-20T09:02:11-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41782"},{"title":"How many pickups occurred in each cluster?","text":"%sql\n\nSELECT prediction, count(prediction) as count from uber group By prediction order by count","user":"anonymous","dateUpdated":"2018-02-20T09:04:26-0800","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\tcount\n8\t341\n9\t519\n5\t1550\n6\t5594\n3\t9870\n1\t18464\n7\t26846\n2\t86672\n0\t196370\n4\t234502\n"}]},"apps":[],"jobName":"paragraph_1508852519217_719676004","id":"20171024-064159_1911692807","dateCreated":"2017-10-24T06:41:59-0700","dateStarted":"2018-02-20T08:37:37-0800","dateFinished":"2018-02-20T08:37:47-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41783"},{"title":"which hours of the day and which cluster had the highest number of pickups? ","text":"\nclusters.select(hour($\"dt\").alias(\"hour\"), $\"prediction\")\n.groupBy(\"hour\",\"prediction\").agg(count(\"prediction\")\n.alias(\"count\")).orderBy(desc( \"count\")).show\n","user":"anonymous","dateUpdated":"2018-02-20T08:37:43-0800","config":{"tableHide":false,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+----------+-----+\n|hour|prediction|count|\n+----+----------+-----+\n|  17|         4|16732|\n|  18|         4|15975|\n|  16|         4|15350|\n|  19|         4|15241|\n|  21|         4|15210|\n|  20|         4|14744|\n|  17|         0|14715|\n|  16|         0|14340|\n|  22|         4|14189|\n|  18|         0|14024|\n|  15|         4|13502|\n|  19|         0|12850|\n|  15|         0|12480|\n|  20|         0|11833|\n|  14|         4|11145|\n|  23|         4|10758|\n|  21|         0|10694|\n|  14|         0| 9877|\n|  13|         4| 9589|\n|   7|         0| 9380|\n+----+----------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1506542893568_1500458267","id":"20161031-003546_1652957647","dateCreated":"2017-09-27T13:08:13-0700","dateStarted":"2018-02-20T08:37:43-0800","dateFinished":"2018-02-20T08:37:55-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41784"},{"title":"which hours of the day and which cluster had the highest number of pickups?","text":"z.show(clusters.select(hour($\"dt\").alias(\"hour\"), $\"prediction\")\n.groupBy(\"hour\",\"prediction\").agg(count(\"prediction\")\n.alias(\"count\")).orderBy( \"hour\",\"prediction\"))\n","user":"anonymous","dateUpdated":"2018-02-20T08:54:46-0800","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"helium":{},"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"hour","index":0,"aggr":"sum"}],"values":[{"name":"count","index":2,"aggr":"sum"}],"groups":[{"name":"prediction","index":1,"aggr":"sum"}],"scatter":{"xAxis":{"name":"hour","index":0,"aggr":"sum"},"yAxis":{"name":"prediction","index":1,"aggr":"sum"}}}}],"enabled":true,"editorSetting":{"language":"scala"},"tableHide":false,"title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"hour\tprediction\tcount\n0\t0\t3477\n0\t1\t377\n0\t2\t3171\n0\t3\t256\n0\t4\t6958\n0\t5\t50\n0\t6\t146\n0\t7\t378\n0\t8\t41\n0\t9\t26\n1\t0\t2220\n1\t1\t141\n1\t2\t2142\n1\t3\t156\n1\t4\t5087\n1\t5\t31\n1\t6\t89\n1\t7\t289\n1\t8\t12\n1\t9\t7\n2\t0\t1495\n2\t1\t111\n2\t2\t1593\n2\t3\t137\n2\t4\t3471\n2\t5\t14\n2\t6\t33\n2\t7\t222\n2\t8\t3\n2\t9\t6\n3\t0\t2041\n3\t1\t96\n3\t2\t1542\n3\t3\t170\n3\t4\t3024\n3\t5\t9\n3\t6\t42\n3\t7\t263\n3\t9\t9\n4\t0\t2440\n4\t1\t506\n4\t2\t1752\n4\t3\t189\n4\t4\t2960\n4\t5\t21\n4\t6\t152\n4\t7\t332\n4\t9\t5\n5\t0\t3607\n5\t1\t795\n5\t2\t2407\n5\t3\t228\n5\t4\t3848\n5\t5\t15\n5\t6\t146\n5\t7\t489\n5\t9\t5\n6\t0\t6153\n6\t1\t876\n6\t2\t3045\n6\t3\t321\n6\t4\t6271\n6\t5\t18\n6\t6\t158\n6\t7\t643\n6\t8\t1\n6\t9\t9\n7\t0\t9380\n7\t1\t541\n7\t2\t3630\n7\t3\t364\n7\t4\t8848\n7\t5\t37\n7\t6\t161\n7\t7\t911\n7\t9\t18\n8\t0\t9211\n8\t1\t314\n8\t2\t3489\n8\t3\t348\n8\t4\t9339\n8\t5\t41\n8\t6\t135\n8\t7\t1128\n8\t8\t3\n8\t9\t14\n9\t0\t7806\n9\t1\t415\n9\t2\t3496\n9\t3\t372\n9\t4\t7526\n9\t5\t54\n9\t6\t158\n9\t7\t1284\n9\t8\t2\n9\t9\t16\n10\t0\t7942\n10\t1\t461\n10\t2\t3239\n10\t3\t438\n10\t4\t7854\n10\t5\t75\n10\t6\t180\n10\t7\t1342\n10\t8\t1\n10\t9\t22\n11\t0\t8140\n11\t1\t494\n11\t2\t3353\n11\t3\t534\n11\t4\t8296\n11\t5\t61\n11\t6\t243\n11\t7\t1198\n11\t8\t2\n11\t9\t24\n12\t0\t8073\n12\t1\t690\n12\t2\t3157\n12\t3\t511\n12\t4\t8585\n12\t5\t88\n12\t6\t242\n12\t7\t1109\n12\t8\t2\n12\t9\t24\n13\t0\t8959\n13\t1\t861\n13\t2\t3451\n13\t3\t494\n13\t4\t9589\n13\t5\t86\n13\t6\t297\n13\t7\t1267\n13\t8\t6\n13\t9\t27\n14\t0\t9877\n14\t1\t1428\n14\t2\t3725\n14\t3\t560\n14\t4\t11145\n14\t5\t86\n14\t6\t323\n14\t7\t1284\n14\t8\t3\n14\t9\t36\n15\t0\t12480\n15\t1\t1198\n15\t2\t3944\n15\t3\t628\n15\t4\t13502\n15\t5\t79\n15\t6\t392\n15\t7\t1600\n15\t8\t5\n15\t9\t28\n16\t0\t14340\n16\t1\t1070\n16\t2\t4138\n16\t3\t545\n16\t4\t15350\n16\t5\t105\n16\t6\t397\n16\t7\t1560\n16\t8\t11\n16\t9\t24\n17\t0\t14715\n17\t1\t945\n17\t2\t4904\n17\t3\t552\n17\t4\t16732\n17\t5\t130\n17\t6\t321\n17\t7\t1663\n17\t8\t20\n17\t9\t24\n18\t0\t14024\n18\t1\t1016\n18\t2\t5123\n18\t3\t436\n18\t4\t15975\n18\t5\t105\n18\t6\t337\n18\t7\t1739\n18\t8\t21\n18\t9\t36\n19\t0\t12850\n19\t1\t1252\n19\t2\t4946\n19\t3\t452\n19\t4\t15241\n19\t5\t103\n19\t6\t356\n19\t7\t1750\n19\t8\t21\n19\t9\t29\n20\t0\t11833\n20\t1\t1307\n20\t2\t5285\n20\t3\t563\n20\t4\t14744\n20\t5\t75\n20\t6\t357\n20\t7\t1942\n20\t8\t39\n20\t9\t30\n21\t0\t10694\n21\t1\t1280\n21\t2\t5448\n21\t3\t683\n21\t4\t15210\n21\t5\t105\n21\t6\t322\n21\t7\t1977\n21\t8\t58\n21\t9\t41\n22\t0\t8843\n22\t1\t1226\n22\t2\t5290\n22\t3\t521\n22\t4\t14189\n22\t5\t87\n22\t6\t331\n22\t7\t1669\n22\t8\t55\n22\t9\t33\n23\t0\t5770\n23\t1\t1064\n23\t2\t4402\n23\t3\t412\n23\t4\t10758\n23\t5\t75\n23\t6\t276\n23\t7\t807\n23\t8\t35\n23\t9\t26\n"}]},"apps":[],"jobName":"paragraph_1506542893569_1500073518","id":"20161031-005512_510256311","dateCreated":"2017-09-27T13:08:13-0700","dateStarted":"2018-02-20T08:54:46-0800","dateFinished":"2018-02-20T08:54:50-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41785"},{"title":"which hours of the day and which cluster had the highest number of pickups?","text":"%sql\nSELECT hour(uber.dt) as hr,prediction, count(prediction) as ct FROM uber group By hour(uber.dt), prediction","user":"anonymous","dateUpdated":"2018-02-20T09:11:55-0800","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"hr","index":0,"aggr":"sum"}],"groups":[{"name":"prediction","index":1,"aggr":"sum"}],"values":[{"name":"ct","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"hr\tprediction\tct\n10\t2\t3239\n23\t6\t276\n16\t3\t545\n17\t2\t4904\n17\t1\t945\n1\t0\t2220\n6\t1\t876\n3\t1\t96\n17\t3\t552\n7\t4\t8848\n22\t8\t55\n2\t2\t1593\n22\t9\t33\n18\t1\t1016\n22\t6\t331\n8\t9\t14\n9\t4\t7526\n8\t3\t348\n12\t7\t1109\n19\t2\t4946\n13\t8\t6\n20\t2\t5285\n1\t7\t289\n11\t8\t2\n2\t3\t137\n4\t7\t332\n7\t1\t541\n11\t6\t243\n12\t2\t3157\n1\t2\t2142\n16\t2\t4138\n13\t7\t1267\n0\t7\t378\n11\t1\t494\n9\t1\t415\n6\t0\t6153\n23\t0\t5770\n4\t0\t2440\n17\t7\t1663\n16\t8\t11\n15\t1\t1198\n1\t9\t7\n13\t9\t27\n0\t5\t50\n23\t2\t4402\n5\t7\t489\n15\t5\t79\n5\t6\t146\n12\t1\t690\n16\t0\t14340\n15\t6\t392\n14\t3\t560\n6\t8\t1\n10\t5\t75\n16\t4\t15350\n1\t1\t141\n9\t7\t1284\n4\t9\t5\n6\t5\t18\n1\t3\t156\n20\t3\t563\n11\t4\t8296\n10\t6\t180\n18\t9\t36\n19\t1\t1252\n11\t7\t1198\n21\t5\t105\n3\t5\t9\n13\t5\t86\n15\t2\t3944\n2\t5\t14\n21\t6\t322\n15\t8\t5\n0\t0\t3477\n7\t2\t3630\n17\t6\t321\n16\t9\t24\n1\t4\t5087\n14\t2\t3725\n5\t4\t3848\n18\t8\t21\n12\t5\t88\n7\t9\t18\n21\t3\t683\n23\t3\t412\n2\t9\t6\n14\t4\t11145\n21\t2\t5448\n10\t4\t7854\n7\t3\t364\n10\t1\t461\n11\t5\t61\n19\t4\t15241\n3\t3\t170\n15\t7\t1600\n23\t5\t75\n9\t3\t372\n1\t8\t12\n9\t2\t3496\n21\t4\t15210\n16\t7\t1560\n17\t8\t20\n8\t5\t41\n11\t9\t24\n8\t1\t314\n17\t9\t24\n13\t4\t9589\n0\t9\t26\n21\t7\t1977\n4\t3\t189\n22\t0\t8843\n6\t7\t643\n2\t1\t111\n14\t6\t323\n18\t6\t337\n15\t9\t28\n8\t8\t3\n2\t4\t3471\n14\t0\t9877\n11\t3\t534\n18\t5\t105\n4\t6\t152\n20\t5\t75\n21\t0\t10694\n21\t8\t58\n6\t3\t321\n12\t0\t8073\n13\t3\t494\n9\t8\t2\n19\t6\t356\n8\t7\t1128\n12\t8\t2\n3\t6\t42\n8\t2\t3489\n7\t5\t37\n13\t6\t297\n6\t2\t3045\n16\t1\t1070\n9\t5\t54\n16\t6\t397\n3\t9\t9\n10\t9\t22\n23\t7\t807\n20\t8\t39\n18\t0\t14024\n12\t4\t8585\n19\t7\t1750\n0\t1\t377\n2\t0\t1495\n11\t0\t8140\n17\t4\t16732\n21\t1\t1280\n18\t2\t5123\n14\t9\t36\n20\t0\t11833\n20\t7\t1942\n18\t4\t15975\n20\t1\t1307\n12\t9\t24\n13\t0\t8959\n23\t8\t35\n22\t7\t1669\n23\t9\t26\n8\t4\t9339\n18\t7\t1739\n13\t2\t3451\n10\t3\t438\n5\t0\t3607\n15\t4\t13502\n0\t8\t41\n3\t2\t1542\n1\t5\t31\n5\t2\t2407\n15\t3\t628\n20\t9\t30\n5\t1\t795\n8\t0\t9211\n14\t7\t1284\n5\t3\t228\n9\t0\t7806\n19\t9\t29\n20\t4\t14744\n23\t4\t10758\n0\t6\t146\n19\t3\t452\n9\t9\t16\n12\t6\t242\n18\t3\t436\n0\t2\t3171\n7\t7\t911\n23\t1\t1064\n3\t4\t3024\n4\t2\t1752\n19\t5\t103\n14\t1\t1428\n22\t5\t87\n4\t4\t2960\n11\t2\t3353\n17\t5\t130\n21\t9\t41\n6\t6\t158\n8\t6\t135\n2\t8\t3\n0\t3\t256\n10\t7\t1342\n3\t0\t2041\n20\t6\t357\n1\t6\t89\n9\t6\t158\n10\t0\t7942\n4\t1\t506\n14\t5\t86\n3\t7\t263\n13\t1\t861\n6\t9\t9\n19\t0\t12850\n0\t4\t6958\n16\t5\t105\n5\t9\t5\n19\t8\t21\n2\t7\t222\n12\t3\t511\n22\t2\t5290\n17\t0\t14715\n14\t8\t3\n4\t5\t21\n22\t4\t14189\n5\t5\t15\n15\t0\t12480\n7\t0\t9380\n7\t6\t161\n22\t1\t1226\n22\t3\t521\n6\t4\t6271\n10\t8\t1\n2\t6\t33\n"}]},"apps":[],"jobName":"paragraph_1519146671145_-1506209469","id":"20180220-091111_784226028","dateCreated":"2018-02-20T09:11:11-0800","dateStarted":"2018-02-20T09:11:36-0800","dateFinished":"2018-02-20T09:11:40-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41786"},{"title":"Which hours of the day  had the highest number of pickups?","text":"z.show(sqlContext.sql(\"SELECT hour(uber.dt) as hr,count(prediction) as ct FROM uber group By hour(uber.dt)\"))","user":"anonymous","dateUpdated":"2018-02-20T09:06:47-0800","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"helium":{},"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"hr","index":0,"aggr":"sum"}],"values":[{"name":"ct","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"hr","index":0,"aggr":"sum"},"yAxis":{"name":"ct","index":1,"aggr":"sum"}},"setting":{"multiBarChart":{}},"commonSetting":{}}}],"enabled":true,"editorSetting":{"language":"scala"},"editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"hr\tct\n12\t22481\n22\t32244\n1\t10174\n13\t25037\n6\t17495\n16\t37540\n3\t7196\n20\t36175\n5\t11540\n19\t37000\n15\t33856\n9\t21129\n17\t40006\n4\t8357\n8\t24022\n23\t23625\n7\t23890\n10\t21554\n21\t35818\n11\t22345\n14\t28467\n2\t7085\n0\t14880\n18\t38812\n"}]},"apps":[],"jobName":"paragraph_1506542893570_1501227765","id":"20161031-005940_1796057341","dateCreated":"2017-09-27T13:08:13-0700","dateStarted":"2017-11-16T12:27:52-0800","dateFinished":"2017-11-16T12:27:57-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41787"},{"text":"  model.write.overwrite().save(\"/user/user01/data/savemodel\")","user":"anonymous","dateUpdated":"2017-11-16T12:55:47-0800","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[],"enabled":true,"editorSetting":{"language":"scala"},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506542893571_1500843016","id":"20161116-075433_1562509402","dateCreated":"2017-09-27T13:08:13-0700","dateStarted":"2017-10-24T10:07:24-0700","dateFinished":"2017-10-24T10:07:26-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:41788"},{"text":"","dateUpdated":"2017-11-16T12:55:47-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1506542893572_1498919272","id":"20161213-063243_842303880","dateCreated":"2017-09-27T13:08:13-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41789"}],"name":"Spark ML KMeans - Uber","id":"2CV4N22S6","angularObjects":{"2CTHAGJ51:shared_process":[],"2CTFEJCW1:shared_process":[],"2CU928YA7:shared_process":[],"2CUSCHS1V:shared_process":[],"2CTGXT5AB:shared_process":[],"2CUHXVGRB:shared_process":[],"2CSNF42WC:shared_process":[],"2CU45S3XK:shared_process":[],"2CV35ABMV:shared_process":[],"2CUH4E5VP:shared_process":[],"2CVNXVD14:shared_process":[],"2CW8GSR5S:shared_process":[],"2CWBB1M88:shared_process":[],"2CT4ZSMCD:shared_process":[],"2CUQTDJZW:shared_process":[],"2CSMEVREU:shared_process":[],"2CVD5FM5C:shared_process":[],"2CTNB4WJK:shared_process":[],"2CUBZKAK6:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}